
@using APBox.Context;

@{
    var sucursalId = Convert.ToInt32(Session["SucursalId"]);
    var _db = new APBoxContext();
    var usuarioId = Convert.ToInt32(Session["UsuarioId"]);
    var usuario = _db.Usuarios.Find(usuarioId);

    var sucursal = _db.Sucursales.Find(sucursalId);
}

<div class="header-top-container container-xxl sabi d-flex flex-grow-1 flex-stack" style="background-image: url(/_CDN/assets/media/background.png)">

    <!--begin::Header Logo-->
    <div class="d-flex align-items-center me-5">
        <!--begin::Heaeder menu toggle-->
        <div class="d-lg-none btn btn-icon btn-active-color-300 w-30px h-30px me-2" id="kt_header_menu_toggle">
            <!--begin::Svg Icon | path: icons/duotune/abstract/abs015.svg-->
            <span class="svg-icon svg-icon-2">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 7H3C2.4 7 2 6.6 2 6V4C2 3.4 2.4 3 3 3H21C21.6 3 22 3.4 22 4V6C22 6.6 21.6 7 21 7Z" fill="currentColor" />
                    <path opacity="0.3" d="M21 14H3C2.4 14 2 13.6 2 13V11C2 10.4 2.4 10 3 10H21C21.6 10 22 10.4 22 11V13C22 13.6 21.6 14 21 14ZM22 20V18C22 17.4 21.6 17 21 17H3C2.4 17 2 17.4 2 18V20C2 20.6 2.4 21 3 21H21C21.6 21 22 20.6 22 20Z" fill="currentColor" />
                </svg>
            </span>
            <!--end::Svg Icon-->
        </div>
        <!--end::Heaeder menu toggle-->
        <!--begin::Logo-->
        <a href="/Home/Index">
            <!--begin::Desktop modes-->
            <img alt="Logo" src="~/_CDN/assets/media/logos/logo_Apbox.png" class="d-none d-lg-inline-block h-30px" />
            <!--end::Desktop modes-->
            <!--begin::Table & mobile modes-->
            <img alt="Logo" src="~/_CDN/assets/media/logos/logo_Apbox.png" class="d-lg-none h-25px" />
            <!--end::Table & mobile modes-->
        </a>
        <!--end::Logo-->
    </div>
    <!--end::Header Logo-->
    <!--begin::Toolbar wrapper-->
    <div class="topbar d-flex align-items-stretch flex-shrink-0" id="kt_topbar">

        <div class="d-flex align-items-center ms-2 ms-lg-3" id="kt_header_user_menu_toggle">
            <!--begin::Menu wrapper-->
            <div class="cursor-pointer symbol symbol-30px symbol-md-40px" data-kt-menu-trigger="click" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">
                <img src="~/_CDN/assets/media/logos/user_hombre.png" alt="user" />
            </div>

           
            <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg menu-state-color fw-semibold py-4 fs-6 w-275px" data-kt-menu="true">
                <!--begin::Menu item-->
                @if (Request.IsAuthenticated && sucursalId != 0)
                {
                    <div class="menu-item px-3">
                        <div class="menu-content d-flex align-items-center px-3">
                            <!--begin::Avatar-->
                            <div class="symbol symbol-50px me-5">
                                <img alt="Logo" src="~/assets/media/logos/user_hombre.png" />
                            </div>
                            <!--end::Avatar-->
                            <!--begin::Username-->


                            <div class="d-flex flex-column">
                                <div class="fw-bold d-flex align-items-center fs-5">
                                    @usuario.Nombre

                                </div>
                                <a href="#" class="fw-semibold text-muted text-hover-primary fs-7">@sucursal.RazonSocial</a>
                            </div>
                            <!--end::Username-->
                        </div>
                    </div>


                    <div class="menu-item px-5 my-1" onclick="location.href='@Url.Action("Manage", "Account")';return false;">
                        <a class="menu-link px-5">Cambiar Contraseña</a>

                    </div>

                    <!--end::Menu item-->
                    <!--begin::Menu item-->
                    <div class="menu-item px-5 ">
                        @using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm" }))
                        {
                            @Html.AntiForgeryToken()
                            {
                                <a href="javascript:document.getElementById('logoutForm').submit()" class="btn display-block font-normal btn-danger ">
                                    <i class="glyph-icon icon-power-off"></i>Cerrar Sesión
                                </a>
                            }
                        }
                    </div>

                    <!--end::Menu item-->
                }
                else
                {
                    

                    <div class="menu-item px-5 my-1" onclick="location.href='@Url.Action("Login", "Account")'; return false;">
                        <a class="menu-link px-5">Iniciar Sesión</a>

                    </div>
                }

            </div>


    </div>
    <!--end::User -->
                <!--begin::Heaeder menu toggle-->
                <!--end::Heaeder menu toggle-->
            </div>
    <!--end::Toolbar wrapper-->
</div>
